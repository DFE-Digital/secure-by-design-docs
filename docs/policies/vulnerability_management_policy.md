# Terminology

| Term       | Meaning / Application                                               |
| ---------- | ------------------------------------------------------------------- |
| Must       | This term is used to state a mandatory requirement of this policy   |
| Should     | This term is used to state a recommended requirement of this policy |
| May        | This term is used to state an optional requirement of this policy   |

# Vulnerability management policy

## Purpose
The purpose of this policy is to identify, prioritise and mitigate vulnerabilities within DfE (Department for Education) digital services, infrastructure and software to preserve the confidentiality, integrity, and availability of DfE data.

## Responsibility
The digital service teams and portfolios are responsible for ensuring they mitigate vulnerabilities within their software and infrastructure.

### RACI

| Tasks                               | Developers/DevOps | Service Owners | VM team |
| ----------------------------------- | ----------------- | -------------- | ------- |
| Patching Azure servers              | R                 | A              | C       |
| Patching software dependencies      | R                 | A              | C       |
| Patching container images           | R                 | A              | C       |
| Fixing SAST vulnerabilities         | R                 | A              | C       |
| Fixing DAST vulnerabilities         | R                 | A              | C       |
| Fixing VDP reported vulnerabilities | R                 | A              | I       |

## Other responsible owners

## Exceptions
Exceptions to this policy are likely to occur. Request for exceptions may include additional time to remediate vulnerabilities, or to let certain systems function normally with vulnerabilities in place. 

Exception requests must be made in writing to the Vulnerability Management team mailbox (vulnerability.management@education.gov.uk) and must contain: 

* the reason for the request
* risk to the department of not following the policy
* specific mitigations that will not be implemented
* technical and other difficulties in applying patches
* date of review 
  
The VM team should also try and obtain confirmation from the Senior Responsible Officer (SRO) and Service Owner that the vulnerability has been approved and has been added to the Services Risk Register (where maintained). Each service is responsible for maintaining an appropriate risk register for their service.

## Policy

### Service level agreements (SLAs)
The service level agreement outlines how quickly vulnerabilities should be fixed based on their risk level - shown in the table below.

| Type                  | Critical   | High        | Medium  | Low     | 
| --------------------- | ---------- | ----------- | ------- | ------- |
| Virtual Machines      | 14 days    | 14 days     | 30 days | 60 days |
| Container images      | 14 days    | 14 days     | 30 days | 60 days |
| Software dependencies | 14 days    | 14 days     | 30 days | 60 days |
| SAST vulnerabilities  | 14 days    | 14 days     | 30 days | 60 days |
| DAST vulnerabilities  | 14 days    | 14 days     | 30 days | 60 days |
| Pen test results      | 14 days    | 14 days     | 30 days | 60 days |
| Threat model results  | 14 days    | 14 days     | 30 days | 60 days |

### Virtual machines
Digital service and portfolio teams are responsible for patching virtual machines they deploy into Azure. 

A patch management process for virtual machines:

* must be documented and approved by an ISO and the vulnerability management lead
* must include daily monitoring of operating system and application patches available
* should be automated wherever possible
* must ensure that patches are installed within [the appropriate SLAs](#service-level-agreements-slas)
* should include reviewing the Continuous Assurance Platform for a single pane of glass review 


### Containers
Digital service and portfolio teams are responsible for patching container images that they:

* use for development
* deploy to AKS or other Azure container services
* use for deployments in CI/CD pipelines

A patch management process for container images:

* must be documented and approved by an ISO and the vulnerability management lead
* must include daily monitoring of container images
* must be integrated into CI/CD pipelines to ensure vulnerable containers are not pushed to production
* should be automated wherever possible
* must ensure that patches are installed within [the appropriate SLAs](#service-level-agreements-slas)
* should include reviewing the Continuous Assurance Platform for a single pane of glass review 

#### Upstream base image vulnerabilities
It is a known issue that some common base images have vulnerabilities that can only be fixed by the upstream maintainers. 

It is *not* considered an appropriate exception to not patch vulnerabilities in container images because of upstream problems. 

In order to ensure that vulnerabilities in container images are patched within appropriate timescales teams must either:

* produce a new base image themselves with up to date patching or;
* fix the missing patches using [multi-stage docker builds](https://technology.blog.gov.uk/2020/06/29/using-multi-stage-docker-builds-to-patch-vulnerable-containers/)


### Software dependencies
Digital service and portfolio teams are responsible for patching software dependencies/libraries.

A patch management process for software dependencies/libraries:

* must be documented and approved by an ISO and the vulnerability management lead
* must include daily monitoring of dependencies
* must be integrated into CI/CD pipelines and repository monitoring to ensure vulnerable libraries are not pushed to production
* should be automated wherever possible (such as with the use of [Dependabot](https://technical-guidance.education.gov.uk/standards/storing-source-code/#dependabot-configuration-options))
* must ensure that patches are installed within [the appropriate SLAs](#service-level-agreements-slas)
* should include reviewing the Continuous Assurance Platform for a single pane of glass review 

dependabot or similar - see dependabot guide
github actions or similar

### Static analysis software testing

### Dynamic analysis software testing

### Pen testing

### Threat modelling

### Assess



### Prioritise

### Remediate

### Monitor

# Revision history

## Revision table

| Date of change | Author             | Review Date          | Version |
| -------------- | ------------------ | -------------------- | ------- |
| YYYY-MM-DD     | FULL_NAME          | YYYY-MM-DD (+1 year) | v0.1    |


## Approved by

| Name            | Title     | Date       | Version |
| --------------- | --------- | ---------- | ------- |
| FULL_NAME       | TITLE     | YYYY-MM-DD | v0.1    |        

# Appendix A: Glossary

# Appendix B: CIS safeguards mapping

# Appendix C: Decision records and history

## Decision record for policy specifics

